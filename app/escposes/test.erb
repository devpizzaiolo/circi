<% if @order.for_pickup? %><%= text("Pickup at:", :font_size => FONT_BIG) %><% else %><%= text("Deliver by:", :font_size => FONT_BIG) %><% end %>
<%= text(@order.to_be_ready_dates_string) %>
<%= text(Escpos::Helpers.bold("Order placed on:")) %>
<%= text(@order.ordered_at_formatted) %>
<% if @order.for_pickup? %><%= text(Escpos::Helpers.bold("Customer:")) %><% else %><%= text(Escpos::Helpers.bold("Customer:")) %><% end %>
<%= text("#{@order.first_name} #{@order.last_name}") %>
<% if @order.for_pickup? %><%= text(@order.contact_phone_number) %><% else %><%= text("#{@order.delivery_address_1}, #{@order.delivery_address_2}\n#{@order.delivery_city}\n#{@order.delivery_postal_code}\n#{@order.phone_number}") %><% end %>
<%= single_splitline %><% unless @order.order_additional.blank? || @order.order_additional == 'null' %><% if @order.order_additional['catering_order'] == "1" %><%= text("CATERING ORDER", :font_size => FONT_BIG) %><%= text("\n#{@order.order_additional['catering_order_group_number']} people") %><% end %><% end %><% if @order.pizza_count > 0 %><%= text("\nPizzas (#{@order.pizza_count.to_s}):\n") %><% count = 0 %><% @order.order_items.each do |oi| %><% if oi.product_info['product_type'] == "pizza" %><% count += 1 %><%= text("\n") %><%= text(Escpos::Helpers.bold(ApplicationController.helpers.print_format_keypair("#{count}. #{if oi.custom == true then "CUSTOM PIZZA" else "#{oi.product_info['product_name']}" end}", "#{oi.price_formatted_with_quantity}" ))) %>
<%= text("#{oi.pizza_size_long_form}\n", :align_type => ALIGN_L) %><%= unless oi.product_info['pizza_size'].include?("gluten-free") then text("Crust: #{oi.product_info['pizza_crust']}") end %><%= unless oi.product_info['pizza_size'].include?("gluten-free") then text(", Style: #{oi.product_info['pizza_crust_style']}") end %><%= text("\n") %><%= text("Quantity: #{oi.quantity}") %><%= text("\n") %><%= single_splitline %><%= text("\n") %><% if oi.toppings_print_arr('whole').count > 0 %><% oi.toppings_print_arr('whole').each do |oil| %><%= text("#{oil[0]}", :align_type => ALIGN_L) %><%= text("#{oil[1]}", :align_type => ALIGN_L) %><%= text("#{oil[2]}", :align_type => ALIGN_R) %><%= text("\n") %><% end %><% end %><% @pizza_preset = PizzaPreset.find(oi[:product_info]['pizza_preset_id']) %><% if @pizza_preset.present? && @pizza_preset.is_product_combo %><% @product_combo = ProductCombo.find(@pizza_preset.product_combo_id) %><%= text("\n") %><% if oi.toppings_print_arr('left').count > 0 %><%= text(Escpos::Helpers.bold("*** Toppings (Side 1) ***\n"), :align_type => ALIGN_C) %><% oi.toppings_print_arr('left').each do |oil| %><%= text("#{oil[0]}", :align_type => ALIGN_L) %><%= text("#{oil[1]}", :align_type => ALIGN_L) %><%= text("#{oil[2]}", :align_type => ALIGN_R) %><%= text("\n") %><% end %><% end %><% if oi.toppings_print_arr('right').count > 0 %><%= text(Escpos::Helpers.bold("*** Toppings (Side 2) ***\n"), :align_type => ALIGN_C) %><% oi.toppings_print_arr('right').each do |oil| %><%= text("#{oil[0]}", :align_type => ALIGN_L) %><%= text("#{oil[1]}", :align_type => ALIGN_L) %><%= text("#{oil[2]}", :align_type => ALIGN_R) %><%= text("\n") %><% end %><% end %><%= text("\n") %><%= text(Escpos::Helpers.bold("*** Additional items ***\n"), :align_type => ALIGN_C) %><% if oi.product_info["order_additional"]['dipping_sauces'] && oi.product_info["order_additional"]['dipping_sauces'].count > 0 %><% oi.product_info["order_additional"]['dipping_sauces'].each do |dipping_sauce| %><% if dipping_sauce[1].to_i > 0 %><%= text(ApplicationController.helpers.print_format_keypair("#{ApplicationController.helpers.get_dipping_sauce_name(dipping_sauce[0])} x "," #{dipping_sauce[1]}")) %><%= text("\n") %><% end %><% end %><% end %><% if oi.product_info["order_additional"]['beverages'] && oi.product_info["order_additional"]['beverages'].count > 0 %><% oi.product_info["order_additional"]['beverages'].each do |beverage| %><% if beverage[1].to_i > 0 %><%= text(ApplicationController.helpers.print_format_keypair("#{ApplicationController.helpers.get_beverage_name(beverage[0])} x ","#{beverage[1]}"),  :align_type => ALIGN_L) %><%= text("\n") %><% end %><% end %><% end %><% end %><% end %><% end %><% end %>
<% if @order.calzone_count > 0 %><%= text("\nCalzones (#{@order.calzone_count.to_s}):\n") %><% count =0 %><% @order.order_items.each do |oi| %><% if oi.product_info['product_type'] == "calzone" %><% count +=1 %><%= text("\n\n") %><%= text(ApplicationController.helpers.print_format_keypair("#{count}. Baked Calzone", "#{oi.price_formatted}")) %><%= text("\n   Crust: #{oi.product_info['calzone_crust']}") %><%= text("\n") %><% if oi.toppings_calzone_print_arr.count > 0 %><%= single_splitline %><% oi.toppings_calzone_print_arr.each do |oil| %><%= text("#{oil[0]}", :align_type => ALIGN_L) %><%= text("#{oil[1]}", :align_type => ALIGN_L) %><%= text("#{oil[2]}", :align_type => ALIGN_R) %><%= text("\n") %><% end %><% end %><% end %><% end %><% end %>
<% unless @order.order_additional.blank? || @order.order_additional == 'null' %><% if @order.beverages_total > 0 %><%= text("\nBeverages:\n") %><%= single_splitline %><% @order.beverages_summary_print.each do |beverage| %><%= text(ApplicationController.helpers.print_format_keypair("#{beverage[0]}","#{beverage[1]}")) %><%= text("\n") %><% end %><% end %><% if @order.garlic_breads_total > 0 %><%= text("\nGarlic Breads:\n", :font_size => FONT_BIG) %><%= single_splitline %><% @order.garlic_breads_summary_print.each do |garlic_bread| %><%= text(ApplicationController.helpers.print_format_keypair("#{garlic_bread[0]}","#{garlic_bread[1]}")) %><%= text("\n") %><% end %><% end %><% if @order.salads_total > 0 %><%= text("\nSalads:\n") %><%= single_splitline %><% @order.salads_summary_print.each do |salad| %><%= text(ApplicationController.helpers.print_format_keypair("#{salad[0]}","#{salad[1]}")) %><%= text("\n") %><% end %><% end %><% if @order.dipping_sauces_total > 0 %><%= text("\nDipping Sauces:\n") %><%= single_splitline %><% @order.dipping_sauces_summary_print.each do |dipping_sauce| %><%= text(ApplicationController.helpers.print_format_keypair("#{dipping_sauce[0]}","#{dipping_sauce[1]}")) %><%= text("\n") %><% end %><% end %><% if @order.order_additional['catering_order'] == "1" %><%= text("\nDesserts:\n") %><%= single_splitline %><% @order.desserts_summary_print.each do |dessert| %><%= text(ApplicationController.helpers.print_format_keypair("#{dessert[0]}","#{dessert[1]}")) %><%= text("\n") %><% end %><% end %><% if @order.order_additional['catering_order'] == "1" %><% if @order.utensils_summary_print.count > 0 %><%= text("\nUtensils:\n") %><%= single_splitline %><% @order.utensils_summary_print.each do |utensil| %><%= text("#{utensil[0]}") %><%= text("\n") %><% end %><% end %><% end %><% end %>
<% unless @order.special_instructions.blank? %><%= text("\nSpecial Instructions:\n", :font_size => FONT_BIG) %><%= single_splitline %><%= text("#{@order.special_instructions}", :font_size => FONT_BIG) %><% end %>
<%= single_splitline %>
<%= text(ApplicationController.helpers.print_format_keypair('Sub-Total:',@order.total_price_formatted)) %>
<%= text(ApplicationController.helpers.print_format_keypair('Delivery:',@order.delivery_formatted)) %>
<%= text(ApplicationController.helpers.print_format_keypair('Tax:',@order.sales_tax_inc_delivery_formatted)) %>
<%= text("                                ----------") %>
<%= text(ApplicationController.helpers.print_format_keypair('TOTAL:',@order.total_price_including_sales_tax_inc_delivery_formatted)) %>
<%= unless @order.for_pickup? then text("Method of payment: #{@order.method_of_payment.try(:name)} ", :align_type => ALIGN_C) end %>
<%= text("                                ----------") %>
<%= text("Ordered from:") %>
<%= text(@order.franchise_location.address) %><%= text("\n#{@order.franchise_location.phone}") %>
<%= text("\x1b\x70\x30\xfff\x0") %>